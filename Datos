import pandas as pd
from inline_sql import sql, sql_val

df = pd.read_csv("/home/Estudiante/Descargas/lista-secciones.csv")
df 

df2 = pd.read_csv("/home/Estudiante/Descargas/lista-sedes.csv")
df2 

df3 = pd.read_csv("/home/Estudiante/Descargas/lista-sedes-datos.csv", on_bad_lines='skip')
df3 

df4 = pd.read_csv("/home/Estudiante/Descargas/P_Data_Extract_From_Global_Bilateral_Migration/migraciones_Data.csv")
df4 


consultaSQL = """
               SELECT sede_id, sede_desc_castellano AS sede, tipo_seccion  
               FROM df;
              """

secciones_corregidas = sql^ consultaSQL
print(secciones_corregidas) 

consultaSQL = """
               SELECT sede_id, sede_desc_castellano AS sede, pais_castellano AS pais, ciudad_castellano AS ciudad, estado, sede_tipo, pais_iso_3 AS iso_3  
               FROM df2;
              """

sede_corregidos = sql^ consultaSQL
print(sede_corregidos)

consultaSQL = """
               SELECT sede_id, sede_desc_castellano AS sede, pais_castellano AS pais, ciudad_castellano AS ciudad, redes_sociales, pais_iso_3 AS iso_3      
               FROM df3;
              """

sede_datos_corregidos = sql^ consultaSQL
print(sede_datos_corregidos)

consultaSQL = """
               SELECT CountryOriginName AS pais_de_origen, CountryOriginCode AS codigo_pais_origen, CountryDestName AS pais_destino, CountryDestCode AS codigo_pais_destino,
               1960[1960] AS 1960, 1970[1970] AS 1970, 1980[1980] AS 1970, 1990[1990] AS 1990, 2000[2000] AS 2000 
               FROM df4
               WHERE NOT 1960 = 0 AND 1970 = 0 AND 1980 = 0 AND 1990 = 0 AND 2000 = 0;
              """

migraciones = sql^ consultaSQL
